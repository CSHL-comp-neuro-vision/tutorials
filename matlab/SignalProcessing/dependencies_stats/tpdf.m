function y = tpdf(x,v)%   TPDF  Probability density function (pdf) for Student's T distribution%   Y = TPDF(X,V) returns the pdf of Student's T distribution with%   V degrees of freedom, at the values in X.%   %   The size of Y is the common size of X and V. A scalar input   %   functions as a constant matrix of the same size as the other input.    if nargin < 2,     error('Requires two input arguments.'); end[errorcode x v] = distchck(2,x,v);if errorcode > 0    error('Requires non-scalar arguments to match in size.');end% Initialize Y to zero, or NaN for invalid d.f.y = zeros(size(x));y(v <= 0) = NaN;% Use gammaln function to avoid overflows.k = find(v > 0);if any(k)    term = exp(gammaln((v(k) + 1) / 2) - gammaln(v(k)/2));    y(k) = term ./ (sqrt(v(k)*pi) .* (1 + (x(k) .^ 2) ./ v(k)) .^ ((v(k) + 1)/2));end