% QTPhotoTest% Checks out QT.mex and the presentation of color images. We read in a% JPEG image and display it in two windows, side by side.% The lefthand window is implemented by SCREEN.mex; the righthand window% is implemented by QT.mex. They should be identical.% % Denis Pelli January, 2000clear mexfilename=fullfile(matlabroot,'toolbox','PsychToolbox','PsychTests','QTPhotoTest.jpg');q=imread(filename,'jpg');r=[0,0,size(q,2),size(q,1)];rr=AlignRect(r,screen(0,'Rect'),RectRight);whichScreen=0;for pixelsize=[16 32]	% set pixelSize	screen(whichScreen,'pixelsize',pixelsize);	if pixelsize==16		norm=256/32;	else		norm=1;	end		% show image, using SCREEN	w=screen(whichScreen,'openwindow',[],r);	screen(w,'putimage',double(q)/norm);	% put file on the desktop.	s=matlabroot;	n=findstr(filesep,s);	root=s(1:n(1));	cd(fullfile(root,'Desktop Folder',''));	filename='q.mov';		% put image in movie, and show it, using QT	window=qt('openwindow',whichScreen,[],rr);	rows=size(q,1);	cols=size(q,2);	trackTimescale=600;	frameDuration=round(trackTimescale/FrameRate(whichScreen)); 	preload=1;	movie=QT('MovieCreate',filename,window);	QT('VideoTrackCreate',movie,rows,cols,trackTimescale,preload);	QT('VideoMediaCreate',movie);	isRGB=1;	QT('VideoMediaSamplesAdd',movie,double(q)/norm,pixelsize,frameDuration,isRGB);	QT('VideoMediaSave',movie);	QT('VideoTrackSamplesSet',movie);	QT('VideoTrackSave',movie);	QT('Show',movie);	QT('MovieSave',movie);	frames=1;	fprintf('Your new %d-frame %d-bit QuickTime movie "%s" is on your desktop.\n',frames,pixelsize,filename);			screen('matlabtofront');	fprintf('Hit RETURN to continue:');	pause	fprintf('\n');	QT('CloseWindow',window);	screen(w,'close')end