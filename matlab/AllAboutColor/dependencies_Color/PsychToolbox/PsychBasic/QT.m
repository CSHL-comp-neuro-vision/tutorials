function QT% QT.mex creates and shows QuickTime movies. Each call corresponds quite% closely to a QuickTime function. If you don't already have it, you% can download the latest version of QuickTime from Apple's web site:% web http://www.apple.com/quicktime/download/% % Apple provides lots of QuickTime documentation (too much!):% web http://developer.apple.com/techpubs/quicktime/qtdevdocs/RM/rmFuncsIndex.htm% % The quickest way to get the hang of using QT.mex is probably to run QTDem.m,% and then read its code. (It's called QTDem because there's a pre-existing% unrelated MATLAB image function called qtdemo.m that does "quad tree" % decompositions.) % % ¥ Create a QuickTime movie:% movie=QT('MovieCreate',filename,window)% QT('VideoTrackCreate',movie,rows,columns,timescale,preload)% QT('VideoMediaCreate',movie)% QT('VideoMediaGraphicsModeSet',movie,graphicsMode,r,g,b)% QT('VideoMediaSamplesAdd',movie,imageArray,pixelSize,frameDuration)% QT('VideoMediaSave',movie)% QT('VideoTrackSamplesSet',movie,startInTrack,startInMedia,durationInMedia,mediaRate)% QT('VideoTrackSave',movie)% QT('MovieUserDataAdd',movie,annotation,OSType)% QT('MovieSave',movie)% % ¥ Show a QuickTime movie:% movie=QT('GetFromFile',filename)% error=QT('LoadIntoRam',movie)% oldHz=QT('Rate',movie,[hz])% oldMagnification=QT('Scale',movie,[magnification])% oldWindow=QT('Window',movie,[window])% QT('Fill',movie,[color],[rect])% QT('Show',movie)% QT('Dispose',movie)% frame=QT('MovieFrameDisplay',movie,[frame,isRelative])% % ¥ Add sound:% movie=QT('Sound',array,[hz])% QT('Add',movie,movie2)% % ¥ Open a window:% [windowPtr,rect]=QT('OpenWindow',screenNumber,[color],[rect]);% QT('CloseWindow',windowPtr)% NOTE:% If you're also using SCREEN, then use SCREEN (not QT) to open and close% all windows. SCREEN maintains an internal list of its windows, and won't% always accept windows made by QT, whereas QT will always be happy to use% SCREEN's windows.% % ¥ Set the CLUT:% clut=QT('GetClut',windowPtrOrScreenNumber,[bits])% QT('SetClut',windowOrScreen,clut,[startEntry,bits])% % ¥ Try QTDem.m and QTTest.m.% % NOTE:% QT.mex is distributed in two ways, as part of the PsychToolbox, and% on its own. The PsychToolbox includes several demos that illustrate the use% of QT.mex. You'll need the PsychToolbox to run those demos. You can download% the PsychToolbox from the website.% web http://color.psych.ucsb.edu/psychtoolbox/download.html#psychtoolboxmac% % NOTE:% The "filename" can be just that, eg 'wave.mov', in the current directory, % or a partial path relative to the current directory, 'Documents:wave.mov', % or a full path, 'HARD_DISK:Documents:wave.mov'. The "filename" string can% be up to 255 characters long. See MATLAB's CD command.% % BUGS:% None.% % COMPRESSION:% At present QT.mex doesn't use any compression in saving your movie% to disk. This provides fast faithful playback from today's hard% disks, which are so fast and cheap ($50/GB). However, to play your% movie on the web you'll want to compress it severely so that even% people connecting to the internet by phone can see it.% % You can use Apple's QuickTime Player to compress your movie:% 0. Upgrade to QuickTime Pro for $30.%    web http://apple.com/quicktime/download/% 1. Open your QuickTime movie in QuickTime Player % 2. From the File menu select Export % 3. From the bottom of the Export dialog, select "Movie to%    QuickTime Movie" from the drop down list.% 4. Click the Options button.% 5. From the "Movie Settings" dialog click Video Settings. % 6. From the "Compression Settings" dialog select "Sorenson%    Video" (or whatever you prefer) as the Compressor.% 7. Enter your settings. Sorenson suggests setting keyframes every%    500 frames (i.e. a large value). Keyframes are sent as complete%    images, independent of what came before; delta frames are%    transmitted as differences from the previous frame. The Sorenson%    Video codec assesses the differences between the frames of your%    movie and automatically inserts keyframes when the difference is%    large. Apparently even the experts do a lot of trial and error in%    finding the best settings. Here are some tips:%    web http://www.terran.com/info/TipsSorenson.html% 8. Click Ok to dismiss the dialogs and compress and save your new movie.% % According to many sources, to attain the ultimate in compression,% one should buy Media Cleaner ($499) and the Developer Version of% Sorenson Video codec ($499). However, the demonstration provided at% the Sorenson web site, showing the same video compressed in both% ways, shows a quite modest difference in quality, not enough to% justify the cost for me. I'm sticking with QuickTime Pro.% web http://www.s-vision.com/products/SorensonVideo/product/whydev.html% web http://www.terran.com/products/CleanerOverview.html% % CREDITS:% QT.mex is based on the "Showtime" MathLink extension for Mathematica% created by A. "Beau" Watson, Cesar Ramirez, and James Hu in the% summer of 1999. All the routines were merged together here as "QT"% by Denis Pelli. Denis's contributions are in polishing the code% (removing bugs, adding the videotoolbox GDOpenWindow, and rewriting% the MediaAdd routine to work at all pixelSizes), and generally% making the whole library reentrant (state information stored solely% in the QTMovie struct, not in the routines) so that the user,% formerly restricted to using only one movie, is now free to work% with an unlimited number of movies at once.% web http://vision.arc.nasa.gov/showtime/% % Denis Pelli						1/00% 7/28/00 dgp Added NOTE above suggesting that users may prefer to use SCREEN,%             not QT, to open and close their windows. (Thanks to Michael S. Beauchamp%             for alerting us to the problem.)