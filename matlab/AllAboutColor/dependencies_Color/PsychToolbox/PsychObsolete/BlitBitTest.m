% BlitBitTest%% Test the bit blit routines.% % OBSOLETE. The BlitBitImage routines are all obsolete. Please use SCREEN% instead. Try MovieDemo.%% Note: for optimal performance in experiments, you may wish to% use Rush to minimize interrupts during the calls to BlitBitImage.% See Rush.% 6/7/95	gmb, dhb	Wrote from gmb's demo.% 6/13/95	dhb				Test rectangle arg as well.% 4/26/97 dhb       Updated.% 5/31/97 dgp       Mention Rush.% 4/1/99 dgp        Reduce array sizes for compatibility with Student MATLAB.% 10/7/99 dgp       Obsolete.% Choose a screen. whichScreen = 0;SCREEN(whichScreen,'PixelSize',8,1); % force 8-bit pixels% Set up some sizesm = 32;n = 32;nimages = 16; bkcolor = 0;% Generate the image sequence.  Makes drifting vertical gratings.% Only generate images if not in workspace.if (~exist('bitImage')) 	disp('Making image sequence');	bitImage=ZeroBitImage([m,n],nimages);	[x,y]=meshgrid(linspace(0,pi*2,m),linspace(0,pi*2,n));	for i=1:nimages		img=125*sin(x-2*pi*i/nimages)+129;		InsertBitImage255(img,bitImage,i);	endelse	disp('Using cached image sequence');end% Set up three color maps and background colordisp('Setting up some color maps');cmap(:,1:3)=((-127:127)')*([-1,1,1])+128; % red-bluecmap(:,4:6)=((-127:127)')*([1,-1,1])+128; % purple-greencmap(:,7:9)=((-127:127)')*([1,1,-1])+128; % yellow-bluecmap(bkcolor+1,:)=128*ones(size(cmap(127,:)));% Generate display sequence.  The color table changes% twice.  Notice that the image that would have been% displayed is just dropped out, not shifted over.% A good idea?  You can write your code either way.disp('Creating display sequence');% Loop through image sequence six timesseq = 1:nimages*6;% First frame is a color map change, and then two% more occur later on.seq(1) = -1;seq(nimages*2)=-2;seq(nimages*4)=-3;% Set nframes, which is the duration of the stimulus (in frames).% We calculate roughly 5 seconds worth.frameRate = 75;nframes=frameRate*5;% Open screenwindow = SCREEN(whichScreen,'OpenWindow',0,[],8);HideCursor;% Set the initial color mapSCREEN(window,'SetClut',cmap(:,1:3));% Clear the screen to bkcolorSCREEN(window,'FillRect',bkcolor);% Blit the images ininfo = BlitBitImage(window,bitImage,size(img),seq,nframes,cmap);disp(sprintf('Showed %g frames in %g seconds',info(1),info(2)));% Blit in at an offset rectangletheRect = [50 50 50+m 50+n];info = BlitBitImage(window,bitImage,size(img),seq,nframes,cmap,theRect);disp(sprintf('Showed %g frames in %g seconds',info(1),info(2)));% Close the screenSCREEN(window,'Close');ShowCursor;