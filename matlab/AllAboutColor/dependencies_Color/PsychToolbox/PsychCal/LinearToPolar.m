function [pol] = LinearToPolar(cal,linear)% [pol] = LinearToPolar(cal,[linear])%% Converts from linear rectangular coordinates to polar% coordinates.%% Polar coordinates are defined as radius, azimuth, and elevation.% 9/9/93			jms		It didn't work for matrix inputs, because a %										matrix '^' needed to be a by-element '.^'% 9/26/93			dhb   Added calData argument.% 2/6/94			jms   Changed 'polar' to 'pol'% 2/20/94			jms   Added single argument case to avoid cData% 4/6/96			dhb		Fixed bug noted by ccc.  Need to use four quadrant%										arctangent atan2().% 5/20/98     dhb   Fix little bug, make sure index is not empty.if (nargin==1)  linear=cal;end[n,m] = size(linear);if (n ~= 3)  error('Cannot handle linear coordinates with dimension other than 3');endpol = zeros(n,m);pol(1,:) = sqrt(linear(1,:).^2 + linear(2,:).^2 + linear(3,:).^2);pol(2,:) = atan2(linear(2,:),linear(1,:));index = find(pol(2,:) < 0);if (~isempty(index))	pol(2,index) = 2*pi*ones(size(index))+pol(2,index);endpol(3,:) = atan(linear(3,:) ./ sqrt(linear(1,:).^2 + linear(2,:).^2) );