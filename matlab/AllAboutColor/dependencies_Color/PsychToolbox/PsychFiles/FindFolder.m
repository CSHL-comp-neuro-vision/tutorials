function directory=FindFolder(name)% directory=FindFolder(name)% Searches the MATLAB 'path' for the path to the named folder.% There may be no matches, one match, or multiple matches.% Each unique match appears as a row in "directory".% If there are no matches then "directory" will be an empty matrix.% Matching ignores case on Macintosh only.% You should DEBLANK a row of "directory" before using it.%% Denis Pelli 7/26/96pathsep = ':';	% path separator characterdirsep = '/';	% directory separator characterignoreCase=0;if strcmp(computer,'MAC2')	pathsep = ';'; dirsep = ':';ignoreCase=1;elseif strcmp(computer,'PCWIN')	pathsep = ';'; dirsep = '\';elseif isvms	pathsep = ','; dirsep='.';endpaths=[path pathsep];if ignoreCase	n=lower(name);	p=lower(paths);else	n=name;	p=paths;endpathIndex=[1 1+findstr(pathsep,p)];nameIndex=[findstr([dirsep n dirsep],p) findstr([dirsep n pathsep],p)];clear n pif isempty(nameIndex)	directory=[];else	nIndex=nameIndex(1);	pIndex=pathIndex(max(find(pathIndex<=nIndex)));	directory=[paths(pIndex:nIndex+length(name)) dirsep];	for i=2:length(nameIndex)		nIndex=nameIndex(i);		pIndex=pathIndex(max(find(pathIndex<=nIndex)));		new=[paths(pIndex:nIndex+length(name)) dirsep];		unique=1;		for j=1:size(directory,1)			if strcmp(deblank(directory(j,:)),new)				unique=0;				break			end		end		if unique			directory=str2mat(directory,new);		end	endend% FindFolder always succeeds. "directory" will have zero to many rows,% each row containing a unique match. % What follows is optional code that you may want to add to your program, after% it calls FindFolder, to give an error unless there was exactly one match.if 0	if isempty(directory)		error(['Can''t find any ''' name ''' folder in the MATLAB path.']);	end	if size(directory,1)>1		for i=1:size(directory,1)			disp(['DUPLICATE: ''' deblank(directory(i,:)) '''']);		end		error(['Found more than one ''' name ''' folder in the MATLAB path.']);	endend