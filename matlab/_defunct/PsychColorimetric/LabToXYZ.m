function XYZ = LabToXYZ(Lab,white)% XYZ = LabToXYZ(Lab,white)%% Convert Lab to XYZ.%% 10/10/93    dhb   Converted from CAP C code.% Check sizes and allocate[m,n] = size(Lab);% Get Y from LstarY = LxxToY(Lab,white);% Compute F[1] = f(Y/Yn) from Y% Because subroutine is a vector routine, we put in and get/% back dummy values for X,ZfakeXYZ = [Y ; Y ; Y];F = XYZToF(fakeXYZ,white);% Compute ratio[0], ratio[2] from a*,b*, and ratio[1] */F(1,:) = (Lab(2,:)/500.0) + F(2,:);F(3,:) = F(2,:) - (Lab(3,:)/200.0);ratio = FToRatio(F);% Compute XYZ from the ratiosXYZ = ratio .* (white*ones(1,n));