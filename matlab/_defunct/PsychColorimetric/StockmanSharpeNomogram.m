function T = StockmanSharpeNomogram(S,lambdaMax)% T = StockmanSharpeNomogram(S,lambdaMax)%% Compute spectral sensitivities according to the% nomogram provided by Stockman and Sharpe:%  http://cvision.ucsd.edu/database/text/pigments/sstemplate.htm%% The result is in quantal units!  To get sensitivity in% energy units, apply EnergyToQuanta().%% Argument lambdaMax may be a column vector of wavelengths.%% 5/8/99		dhb  Started writing it.% 10/27/99	dhb  Added error return to prevent premature use of this routine.error('StockmanSharpeNomogram is not yet finished');% Need to check that formula is for quantal units.% Parametersa =  127249.603438192372;b = -202843.011188543367;c =  113805.985913646308;d = -32275.398627076864;e =  5190.42606056920141;f = -482.083579700827874;g =  24.1918318775095654;h = -0.509214576081529876.% Set up and apply formulawls = MakeItWls(S)';logWls = log10(wls);T = zeros(nT,nWls);for i = 1:nT	% Get lambda max	theMax = lambdaMax(i);		% Need to normalize wavelengths	logWlsNorm = logWls;		% Compute log optical density	logDensity = a + ...						   b*logWlsNorm.^2 + ...							 c*logWlsNorm.^4 + ...							 d*logWlsNorm.^6 + ...							 e*logWlsNorm.^8 + ...							 f*logWlsNorm.^10 + ...							 g*logWlsNorm.^12 + ...							 h*logWlsNorm.^14 + ...	T(:,i) = 10.^logDensity;end