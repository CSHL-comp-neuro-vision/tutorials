global memdataglobal mvmntglobal movement movement2global delay stimulateglobal model fileprefixmodel='model_OPNgated'fileprefix='O';delay=[0 0.036; 10 0.036]; % delayed-leak model requires this value			   % formerly 0.063stimulate=[0 0; 10 0];	   % OPN stimulator requires a value, 0 in this exp.nn=13;movement=zeros(nn,1:10);movement2=zeros(nn,1:10);actualisi=0; amplitudes=0;figure;for ii=1:nn  isi=ii*0.010 + 0.011;  disp(sprintf('isi #%.0f',ii));%  close all;%  mdata=[0.05,-13.98,0; isi+0.1,-7.78,0]; % don't make these less than 26 ms 7.63 apart!mdata=[0.05,-14.765,0; isi+0.1,-8.74,0]; %gated%mdata=[0.05,-14.765,0; isi+0.1,-8.74,0]; %delayed%mdata=[0.05, -13.514,0; isi+0.1,-8.5,0]; %continuous%mdata=[0.05,-14.765,0;isi+0.1,-8.74,0];   fastmakeinput;    [t,x,y]=euler(model,0.35,[],[1e-5,1e-3,1e-3,[],[],1]);  movement(ii,1:10)=mvmnt(1,1:10);  if (size(mvmnt,1)>1)    actualisi(ii)=mvmnt(2,4)-mvmnt(1,5);    amplitudes(ii)=mvmnt(2,8)-mvmnt(2,6);    movement2(ii,1:10)=mvmnt(2,1:10);    end;  trace=[t';y'];  % save the movement trace  filename=sprintf('nic%s%.3f.out',fileprefix,isi);  fid = fopen(filename,'w');  fprintf(fid,'%.3f %.2f\n',trace);  fclose(fid);  plot(trace(1,:), trace(2,:), 'b.');  drawnow;  hold on;  end;% save analysisfilename=sprintf('nic%s.anl1',fileprefix);fid = fopen(filename,'w');for ii=1:size(movement,1)%  fprintf(fid,'actual isi %.3f:',actualisi(ii));  fprintf(fid,'%.1f, %.3f, %.1f, %.3f, %.3f, %.1f, %.1f, %.1f, %.1f, %.3f\n', movement(ii,:));  end;fclose(fid);filename=sprintf('nic%s.anl2',fileprefix);fid = fopen(filename,'w');for ii=1:size(movement2,1)  fprintf(fid,'%.1f, %.3f, %.1f, %.3f, %.3f, %.1f, %.1f, %.1f, %.1f, %,3f\n',movement2(ii,:));  end;fclose(fid)eval(['print -depsc nic' fileprefix 'fig1.ps']);eval(['print -dmfile nic' fileprefix 'fig1.m']);hold off;%make the alternative figure;figure;plot(actualisi,amplitudes,'ro');axis('square')axis([0.02 0.14 -7 1]);drawnow;eval(['print -depsc nic' fileprefix 'fig2.ps']);eval(['print -dmfile nic' fileprefix 'fig2.m']);hold off;